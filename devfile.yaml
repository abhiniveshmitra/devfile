schemaVersion: 2.2.0
metadata:
  name: react-vite-yarn-app
  version: 1.0.0
  description: Devfile for a React + Vite app using Yarn

components:
  - name: nodejs
    container:
      image: node:18
      memoryRequest: 512Mi   # Required to match memoryLimit
      memoryLimit: 512Mi     # Keeps container lightweight but consistent
      mountSources: true
      endpoints:
        - name: vite-dev
          targetPort: 5173
          exposure: public
      command: ["sh", "-c"]
      args:
        - |
          yarn install &&
          yarn vite --host

commands:
  - id: install
    exec:
      component: nodejs
      workingDir: ${PROJECT_SOURCE}
      commandLine: "yarn install"
      group:
        kind: build
        isDefault: true

  - id: dev
    exec:
      component: nodejs
      workingDir: ${PROJECT_SOURCE}
      commandLine: "yarn vite --host"
      group:
        kind: run
        isDefault: true
